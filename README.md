# Task1_OpenSchool_T1_2025

# How to start?

1. Install Docker and Git
2. Clone repo
3. Use
```
    docker compose up
```

# Структура:
- **module1** - основной сервис. Отвечает за проведение транзакций и взаимодействие с базой данных
- **module2** - связан с **module1** через Kafka. Осуществляет подтверждение транзакции: 
  - Если транзакции по одному и тому же клиенту и счету приходят больше N раз в Т времени (настраивается в конфиге) и timestamp транзакции попадает в этот период, то N транзакциям присвоить статус BLOCKED, сообщение со статусом, id счета и id транзакции отправить в топик t1_demo_transaction_result 
  - Если сумма списания в транзакции больше, чем баланс счета - отправить сообщение со статусом REJECTED 
  - Если всё ок, то статус ACCECPTED
- **check-client-service** - к нему обращается **module1** по HTTP для проверки статуса клиента. Осуществляет аутентификацию **module1** с помощью JWT.
  - получении запроса проверяет, находится ли клиент в черном списке (в данном примере - если у клиента uuid заканчивается на чётный символ по ASCII), 
  - отправляет в ответ соответствующий статус. 
- **my-spring-starter** - стартер, подключается к **module1**. В него вынесены аннотации для измерения времени работы метода и обработке исключений доступа к бд.



# Чтобы совершить транзакцию
Перейдите по адресу 
```
localhost:8000
```
и отправьте в топик `t1_demo_transactions`
сообщение
```
{"producer": "00000000-0000-0000-0000-000000000001","consumer": "00000000-0000-0000-0000-000000000002","amount": 200.00}
```